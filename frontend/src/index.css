@tailwind base;
@tailwind components;
@tailwind utilities;

/* Ensure Tailwind `border` utilities use theme border color */
@layer base {
  * { @apply border-border; }
}

/* Light theme: sophisticated neutrals with subtle warmth */
:root {
  /* Base surfaces - matching dark theme contrast ratios (inverted) */
  --background: 220 15% 94%; /* light grey-blue base */
  --foreground: 222.2 47.4% 11.2%; /* near-black text */
  --card: 0 0% 100%; /* pure white cards (6% lighter than bg, matching dark 6%→11%) */
  --card-foreground: 222.2 47.4% 11.2%;
  --popover: 0 0% 100%;
  --popover-foreground: 222.2 47.4% 11.2%;

  /* Brand accents (dark blue) */
  --primary: 221 83% 45%; /* dark blue */
  --primary-foreground: 0 0% 100%; /* white */
  --accent: 221 89% 58%; /* blue (slightly lighter) */
  --accent-foreground: 0 0% 100%;

  /* UI accents - mirroring dark theme's layering */
  --secondary: 220 14% 87%; /* sidebar surface (7% darker than bg, matching dark 6%→13%) */
  --secondary-foreground: 222.2 47.4% 11.2%;
  --muted: 220 12% 82%; /* muted elements (12% darker, matching dark 6%→18%) */
  --muted-foreground: 215 20% 30%; /* darker grey text (mirror of dark's 70%) */
  --destructive: 0 72% 51%;
  --destructive-foreground: 0 0% 100%;
  --border: 220 14% 78%; /* borders (16% darker, matching dark 6%→22%) */
  --input: 220 14% 78%; /* match border for consistency */
  --ring: 221 83% 45%; /* match primary (dark blue) */

  --radius: 0.6rem;
}

/* Status colors for richer button variants */
:root {
  --success: 142 72% 29%;
  --success-foreground: 0 0% 100%;
  --warning: 38 92% 50%;
  --warning-foreground: 222.2 47.4% 11.2%;
  --info: 199 89% 48%;
  --info-foreground: 0 0% 100%;
}

/* Component styles: panels and sidebar links */
@layer components {
  /* Elevated panel with soft, subtle shadow - no harsh 3D */
  .panel-3d { 
    @apply bg-card border border-border rounded-xl shadow-md;
    box-shadow:
      0 1px 2px hsl(0 0% 0% / 0.06),
      0 4px 12px hsl(0 0% 0% / 0.08);
  }
  .dark .panel-3d {
    box-shadow:
      0 1px 2px hsl(0 0% 0% / 0.55),
      0 10px 24px hsl(0 0% 0% / 0.45);
  }
  /* Keep static elevation; no hover lift */

  /* Modern sidebar look with better depth */
  .app-sidebar {
    background: linear-gradient(180deg, hsl(var(--secondary)) 0%, hsl(var(--muted) / 0.6) 100%);
    @apply backdrop-blur-xl border-border/50;
    box-shadow: inset -1px 0 0 hsl(var(--border));
  }

  .sidebar-link {
    @apply relative rounded-lg px-3 py-2.5 text-sm font-medium text-muted-foreground transition-all duration-200 flex items-center gap-3;
    backdrop-filter: blur(4px);
  }
  .sidebar-link:hover { 
    @apply bg-accent/50 text-foreground shadow-sm; 
    transform: translateX(2px);
    background-color: hsl(var(--accent) / 0.12);
  }
  .sidebar-link.is-active { 
    @apply bg-primary/10 text-primary shadow-sm; 
    box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), inset 0 1px 0 0 hsl(var(--primary) / 0.1);
    background-color: hsl(var(--primary) / 0.12);
  }
  .sidebar-link::before {
    content: "";
    position: absolute;
    left: -12px;
    top: 20%;
    bottom: 20%;
    width: 3px;
    border-radius: 9999px;
    background: transparent;
    transform: scaleY(0);
    transition: all 200ms cubic-bezier(0.4, 0, 0.2, 1);
  }
  .sidebar-link:hover::before { 
    background: hsl(var(--accent-foreground) / 0.3); 
    transform: scaleY(0.7); 
  }
  .sidebar-link.is-active::before { 
    background: hsl(var(--primary)); 
    transform: scaleY(1); 
  }
  .sidebar-link svg {
    @apply transition-transform duration-200;
  }
  .sidebar-link:hover svg {
    transform: scale(1.1);
  }
}

/* Dark theme overrides (applied when .dark class is on html) */
.dark {
  /* Base surfaces */
  --background: 220 15% 6%; /* near black */
  --foreground: 210 40% 98%; /* near white */
  --card: 220 15% 11%; /* distinct panel surface */
  --card-foreground: 210 40% 98%;
  --popover: 220 15% 11%;
  --popover-foreground: 210 40% 98%;

  /* Brand accents */
  --primary: 213 90% 56%; /* blue */
  --primary-foreground: 210 40% 98%;
  --accent: 213 90% 56%; /* blue (match primary) */
  --accent-foreground: 210 40% 98%;

  /* UI accents */
  --secondary: 220 14% 13%; /* sidebar/panel-tier surface */
  --secondary-foreground: 210 40% 98%;
  --muted: 220 12% 18%;
  --muted-foreground: 215 20% 70%;
  --destructive: 0 84% 62%;
  --destructive-foreground: 210 40% 98%;
  --border: 220 14% 22%;
  --input: 220 14% 22%;
  --ring: 213 90% 56%; /* match primary (blue) */

  --radius: 0.6rem;

  /* Status colors */
  --success: 142 70% 40%;
  --success-foreground: 210 40% 98%;
  --warning: 48 96% 53%;
  --warning-foreground: 222.2 47.4% 11.2%;
  --info: 199 95% 62%;
  --info-foreground: 210 40% 98%;
}

html, body, #root { height: 100%; }
body {
  background-color: hsl(var(--background));
  color: hsl(var(--foreground));
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  /* Very subtle texture pattern for light theme - matching dark theme subtlety */
  background-image: 
    radial-gradient(circle at 20% 50%, hsl(220 15% 90% / 0.6) 0%, transparent 50%),
    radial-gradient(circle at 80% 80%, hsl(var(--primary) / 0.03) 0%, transparent 50%);
}
.dark body {
  /* Remove background patterns in dark mode for cleaner look */
  background-image: none;
}

/* Subtle card & element transitions */
@layer components {
  .card-transition { @apply transition-colors duration-200; }
  
  /* Enhanced table row contrast for light theme */
  .table-row-hover {
    @apply hover:bg-muted/40 transition-colors;
  }
  
  /* Subtle section backgrounds */
  .section-bg {
    background-color: hsl(var(--card));
    border: 1px solid hsl(var(--border) / 0.5);
  }
  
  /* Enhanced input focus states */
  .input-enhanced {
    background-color: hsl(var(--input));
    transition: all 0.2s ease;
  }
  .input-enhanced:focus {
    background-color: hsl(var(--card));
    border-color: hsl(var(--primary) / 0.5);
    box-shadow: 0 0 0 3px hsl(var(--primary) / 0.1);
  }
}

/* Minimal scrollbars: transparent track, no buttons, visible thumb only */
/* Firefox */
* {
  scrollbar-width: thin;
  scrollbar-color: hsl(var(--muted-foreground) / 0.35) transparent;
}
/* WebKit */
*::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}
*::-webkit-scrollbar-track {
  background: transparent;
}
*::-webkit-scrollbar-thumb {
  background-color: hsl(var(--muted-foreground) / 0.35);
  border-radius: 9999px;
  border: 2px solid transparent;
  background-clip: padding-box;
}
*::-webkit-scrollbar-button {
  display: none;
  width: 0;
  height: 0;
}

/* Electron window controls */
.drag-region {
  -webkit-app-region: drag;
}

.no-drag {
  -webkit-app-region: no-drag;
}

/* DOCX Preview Styling - Comprehensive Word-like rendering */

/* Create isolation layer - block Tailwind inheritance but allow library styles */
.docx-viewer-container {
  /* Don't inherit Tailwind's typography */
  font-family: var(--docx-default-font, Calibri, 'Segoe UI', Arial, sans-serif);
  font-size: var(--docx-default-size, 11pt);
  line-height: 1.15;
  color: #000000;
  letter-spacing: normal;
  word-spacing: normal;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  
  /* Ensure block display */
  display: block;
}

/* Remove any wrapper containers - we only want the sections */
.docx-viewer-container > div {
  all: unset;
  display: block !important;
}

/* Critical: Prevent Tailwind's Preflight reset from affecting docx-preview elements */
.docx-viewer-container *,
.docx-viewer-container *::before,
.docx-viewer-container *::after {
  /* Undo Tailwind's border-box - Word uses content-box for internal elements */
  box-sizing: border-box;
}

/* Undo Tailwind's aggressive resets - let inline styles work */
.docx-viewer-container h1,
.docx-viewer-container h2,
.docx-viewer-container h3,
.docx-viewer-container h4,
.docx-viewer-container h5,
.docx-viewer-container h6 {
  font-weight: inherit;
  font-size: inherit;
  line-height: inherit;
  margin: 0;
}

.docx-viewer-container p {
  margin: 0;
  line-height: inherit;
  white-space: normal;
  word-wrap: break-word;
  overflow-wrap: break-word;
}

.docx-viewer-container table {
  border-collapse: collapse;
  border-spacing: 0;
}

.docx-viewer-container td,
.docx-viewer-container th {
  padding: 0;
  vertical-align: top;
}

.docx-viewer-container ul,
.docx-viewer-container ol {
  margin: 0;
  padding: 0;
}

/* Remove 'all: revert' entirely - it was stripping colors and backgrounds */

/* Apply document metadata to pages - use extracted margins */
.docx-viewer-container section,
.docx-viewer-container article,
.docx-viewer-container .docx-page {
  display: block !important;
  background: white !important;
  margin: 0 auto 20px auto !important;
  box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.08) !important;
  position: relative !important;
  border: none !important;
  outline: none !important;
  
  /* Use document's actual page dimensions if available */
  width: var(--docx-page-width, 8.5in) !important;
  min-height: var(--docx-page-height, 11in) !important;
  
  /* Apply extracted margins - this creates the white space around content */
  padding-top: var(--docx-margin-top, 0) !important;
  padding-bottom: var(--docx-margin-bottom, 0) !important;
  padding-left: var(--docx-margin-left, 0) !important;
  padding-right: var(--docx-margin-right, 0) !important;
  
  box-sizing: border-box !important;
  overflow: visible !important;
}

/* Remove extra borders/outlines/shadows from any wrapper elements */
.docx-viewer-container .docx-wrapper,
.docx-viewer-container > div,
.docx-viewer-container > div > * {
  border: none !important;
  outline: none !important;
  box-shadow: none !important;
  background: transparent !important;
  margin: 0 !important;
  padding: 0 !important;
}

/* Ensure no pseudo-elements create duplicate shadows */
.docx-viewer-container section::before,
.docx-viewer-container section::after,
.docx-viewer-container article::before,
.docx-viewer-container article::after,
.docx-viewer-container .docx-page::before,
.docx-viewer-container .docx-page::after {
  display: none !important;
  content: none !important;
}

.docx-viewer-container section:last-child,
.docx-viewer-container article:last-child,
.docx-viewer-container .docx-page:last-child {
  margin-bottom: 0 !important;
}

/* Force page break rendering - handle inline page break markers */
.docx-viewer-container br[style*="page-break"],
.docx-viewer-container .page-break,
.docx-viewer-container [data-page-break],
.docx-viewer-container .docx-page-break {
  display: block !important;
  page-break-after: always !important;
  break-after: page !important;
  height: 0 !important;
  margin: 0 !important;
  padding: 0 !important;
  border: none !important;
}

/* Ensure proper text rendering */
.docx-viewer-container * {
  text-rendering: optimizeLegibility;
}

/* Fix list rendering */
.docx-viewer-container ul {
  list-style-position: outside;
  margin-left: 0.5in;
}

.docx-viewer-container ol {
  list-style-position: outside;
  margin-left: 0.5in;
}

/* Preserve hyperlinks */
.docx-viewer-container a {
  color: #0563c1;
  text-decoration: underline;
}

/* Ensure images display correctly */
.docx-viewer-container img {
  max-width: 100%;
  height: auto;
  display: inline-block;
  vertical-align: baseline;
}
